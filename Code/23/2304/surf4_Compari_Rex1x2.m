clc
clear
% 用来算平凡解

%系数
% A=u_a^*
% B=\frac{1}{\rho\phi}
% C=\alpha
% D=k_a
% E=k_{\theta}
% F=k_b
% H=\frac{1}{h_2}
% X=\lambda - here is F
A=1;
B=1;
C=pi/6;

F=0;

G=1;

H=1;

%网格
L = 0.5;
x = linspace(-L,L,100);
y = linspace(-100*L,100*L,100);

[X,Y]=meshgrid(x,y);

%解的函数关系
UP1=- ((X.^2 + Y.^2.*H.^2 + F.^2).*(3.*A.*X.^2.*H.*cos(C) - real((- 8.*(X.^2 - cos(C).*X.*H.*1i + Y.^2.*H.^2 + F.^2 - sin(C).*F.*H.*1i).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + A.*F.^2.*H.*cos(C) + 2.*A.*X.*F.*H.*sin(C) + 3.*X.*Y.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*cos(C) + Y.*F.*G.*H.^2.*sin(C)))./(2.*((X.^2 + Y.^2.*H.^2 + F.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2)) + ((X.*H.*cos(C) + F.*H.*sin(C)).*(2.*A.*X.^3 - imag((- 8.*(X.^2 - cos(C).*X.*H.*1i + Y.^2.*H.^2 + F.^2 - sin(C).*F.*H.*1i).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 2.*A.*X.*F.^2 + 2.*Y.^3.*G.*H.^3 + 2.*A.*X.*Y.^2.*H.^2 - A.*X.*H.^2.*cos(C).^2 - 2.*Y.*G.*H.^3.*cos(C).^2 - (A.*F.*H.^2.*sin(2.*C))./2 - Y.*G.*H.^3.*sin(2.*C) + 2.*X.^2.*Y.*G.*H + 2.*Y.*F.^2.*G.*H))./(2.*((X.^2 + Y.^2.*H.^2 + F.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2));
 
UP2=- ((F.^2 + Y.^2.*H.^2 + X.^2).*(real((- 8.*(F.^2 - sin(C).*F.*H.*1i + Y.^2.*H.^2 - cos(C).*X.*H.*1i + X.^2).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 3.*A.*X.^2.*H.*cos(C) + A.*F.^2.*H.*cos(C) + 2.*A.*X.*F.*H.*sin(C) + 3.*X.*Y.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*cos(C) + Y.*F.*G.*H.^2.*sin(C)))./(2.*((F.^2 + Y.^2.*H.^2 + X.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2)) + ((X.*H.*cos(C) + F.*H.*sin(C)).*(imag((- 8.*(F.^2 - sin(C).*F.*H.*1i + Y.^2.*H.^2 - cos(C).*X.*H.*1i + X.^2).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 2.*A.*X.^3 + 2.*A.*X.*F.^2 + 2.*Y.^3.*G.*H.^3 + 2.*A.*X.*Y.^2.*H.^2 - A.*X.*H.^2.*cos(C).^2 - 2.*Y.*G.*H.^3.*cos(C).^2 - (A.*F.*H.^2.*sin(2.*C))./2 - Y.*G.*H.^3.*sin(2.*C) + 2.*X.^2.*Y.*G.*H + 2.*Y.*F.^2.*G.*H))./(2.*((F.^2 + Y.^2.*H.^2 + X.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2));

UP=UP2-UP1;
%
subplot(2,2,1)
surf(X,Y,UP);

zlim([-inf,inf])

legend('Re[\lambda]_{x_2}-Re[\lambda]_{x_1(base-state)} at k_b=0','Location','northwest')

%colorbar;
xlabel('k_a')
ylabel('k_{\theta}')
zlabel('\Delta Re[\lambda]')
title('k_b=0')

%
F=1;

%解的函数关系
UP1=- ((X.^2 + Y.^2.*H.^2 + F.^2).*(3.*A.*X.^2.*H.*cos(C) - real((- 8.*(X.^2 - cos(C).*X.*H.*1i + Y.^2.*H.^2 + F.^2 - sin(C).*F.*H.*1i).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + A.*F.^2.*H.*cos(C) + 2.*A.*X.*F.*H.*sin(C) + 3.*X.*Y.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*cos(C) + Y.*F.*G.*H.^2.*sin(C)))./(2.*((X.^2 + Y.^2.*H.^2 + F.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2)) + ((X.*H.*cos(C) + F.*H.*sin(C)).*(2.*A.*X.^3 - imag((- 8.*(X.^2 - cos(C).*X.*H.*1i + Y.^2.*H.^2 + F.^2 - sin(C).*F.*H.*1i).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 2.*A.*X.*F.^2 + 2.*Y.^3.*G.*H.^3 + 2.*A.*X.*Y.^2.*H.^2 - A.*X.*H.^2.*cos(C).^2 - 2.*Y.*G.*H.^3.*cos(C).^2 - (A.*F.*H.^2.*sin(2.*C))./2 - Y.*G.*H.^3.*sin(2.*C) + 2.*X.^2.*Y.*G.*H + 2.*Y.*F.^2.*G.*H))./(2.*((X.^2 + Y.^2.*H.^2 + F.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2));
 
UP2=- ((F.^2 + Y.^2.*H.^2 + X.^2).*(real((- 8.*(F.^2 - sin(C).*F.*H.*1i + Y.^2.*H.^2 - cos(C).*X.*H.*1i + X.^2).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 3.*A.*X.^2.*H.*cos(C) + A.*F.^2.*H.*cos(C) + 2.*A.*X.*F.*H.*sin(C) + 3.*X.*Y.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*cos(C) + Y.*F.*G.*H.^2.*sin(C)))./(2.*((F.^2 + Y.^2.*H.^2 + X.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2)) + ((X.*H.*cos(C) + F.*H.*sin(C)).*(imag((- 8.*(F.^2 - sin(C).*F.*H.*1i + Y.^2.*H.^2 - cos(C).*X.*H.*1i + X.^2).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 2.*A.*X.^3 + 2.*A.*X.*F.^2 + 2.*Y.^3.*G.*H.^3 + 2.*A.*X.*Y.^2.*H.^2 - A.*X.*H.^2.*cos(C).^2 - 2.*Y.*G.*H.^3.*cos(C).^2 - (A.*F.*H.^2.*sin(2.*C))./2 - Y.*G.*H.^3.*sin(2.*C) + 2.*X.^2.*Y.*G.*H + 2.*Y.*F.^2.*G.*H))./(2.*((F.^2 + Y.^2.*H.^2 + X.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2));

UP=UP2-UP1;


%
subplot(2,2,2)
surf(X,Y,UP);

zlim([-inf,inf])

legend('Re[\lambda]_{x_2}-Re[\lambda]_{x_1(base-state)} at k_b=1','Location','northwest')

%colorbar;
xlabel('k_a')
ylabel('k_{\theta}')
zlabel('\Delta Re[\lambda]')
title('k_b=1')

%
F=5;

%解的函数关系
UP1=- ((X.^2 + Y.^2.*H.^2 + F.^2).*(3.*A.*X.^2.*H.*cos(C) - real((- 8.*(X.^2 - cos(C).*X.*H.*1i + Y.^2.*H.^2 + F.^2 - sin(C).*F.*H.*1i).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + A.*F.^2.*H.*cos(C) + 2.*A.*X.*F.*H.*sin(C) + 3.*X.*Y.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*cos(C) + Y.*F.*G.*H.^2.*sin(C)))./(2.*((X.^2 + Y.^2.*H.^2 + F.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2)) + ((X.*H.*cos(C) + F.*H.*sin(C)).*(2.*A.*X.^3 - imag((- 8.*(X.^2 - cos(C).*X.*H.*1i + Y.^2.*H.^2 + F.^2 - sin(C).*F.*H.*1i).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 2.*A.*X.*F.^2 + 2.*Y.^3.*G.*H.^3 + 2.*A.*X.*Y.^2.*H.^2 - A.*X.*H.^2.*cos(C).^2 - 2.*Y.*G.*H.^3.*cos(C).^2 - (A.*F.*H.^2.*sin(2.*C))./2 - Y.*G.*H.^3.*sin(2.*C) + 2.*X.^2.*Y.*G.*H + 2.*Y.*F.^2.*G.*H))./(2.*((X.^2 + Y.^2.*H.^2 + F.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2));
 
UP2=- ((F.^2 + Y.^2.*H.^2 + X.^2).*(real((- 8.*(F.^2 - sin(C).*F.*H.*1i + Y.^2.*H.^2 - cos(C).*X.*H.*1i + X.^2).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 3.*A.*X.^2.*H.*cos(C) + A.*F.^2.*H.*cos(C) + 2.*A.*X.*F.*H.*sin(C) + 3.*X.*Y.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*cos(C) + Y.*F.*G.*H.^2.*sin(C)))./(2.*((F.^2 + Y.^2.*H.^2 + X.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2)) + ((X.*H.*cos(C) + F.*H.*sin(C)).*(imag((- 8.*(F.^2 - sin(C).*F.*H.*1i + Y.^2.*H.^2 - cos(C).*X.*H.*1i + X.^2).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 2.*A.*X.^3 + 2.*A.*X.*F.^2 + 2.*Y.^3.*G.*H.^3 + 2.*A.*X.*Y.^2.*H.^2 - A.*X.*H.^2.*cos(C).^2 - 2.*Y.*G.*H.^3.*cos(C).^2 - (A.*F.*H.^2.*sin(2.*C))./2 - Y.*G.*H.^3.*sin(2.*C) + 2.*X.^2.*Y.*G.*H + 2.*Y.*F.^2.*G.*H))./(2.*((F.^2 + Y.^2.*H.^2 + X.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2));

UP=UP2-UP1; 


%
subplot(2,2,3)
surf(X,Y,UP);

zlim([-inf,inf])

legend('Re[\lambda]_{x_2}-Re[\lambda]_{x_1(base-state)} at k_b=5','Location','northwest')

%colorbar;
xlabel('k_a')
ylabel('k_{\theta}')
zlabel('\Delta Re[\lambda]')
title('k_b=5')

%
F=10;

%解的函数关系
UP1=- ((X.^2 + Y.^2.*H.^2 + F.^2).*(3.*A.*X.^2.*H.*cos(C) - real((- 8.*(X.^2 - cos(C).*X.*H.*1i + Y.^2.*H.^2 + F.^2 - sin(C).*F.*H.*1i).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + A.*F.^2.*H.*cos(C) + 2.*A.*X.*F.*H.*sin(C) + 3.*X.*Y.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*cos(C) + Y.*F.*G.*H.^2.*sin(C)))./(2.*((X.^2 + Y.^2.*H.^2 + F.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2)) + ((X.*H.*cos(C) + F.*H.*sin(C)).*(2.*A.*X.^3 - imag((- 8.*(X.^2 - cos(C).*X.*H.*1i + Y.^2.*H.^2 + F.^2 - sin(C).*F.*H.*1i).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 2.*A.*X.*F.^2 + 2.*Y.^3.*G.*H.^3 + 2.*A.*X.*Y.^2.*H.^2 - A.*X.*H.^2.*cos(C).^2 - 2.*Y.*G.*H.^3.*cos(C).^2 - (A.*F.*H.^2.*sin(2.*C))./2 - Y.*G.*H.^3.*sin(2.*C) + 2.*X.^2.*Y.*G.*H + 2.*Y.*F.^2.*G.*H))./(2.*((X.^2 + Y.^2.*H.^2 + F.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2));
 
UP2=- ((F.^2 + Y.^2.*H.^2 + X.^2).*(real((- 8.*(F.^2 - sin(C).*F.*H.*1i + Y.^2.*H.^2 - cos(C).*X.*H.*1i + X.^2).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 3.*A.*X.^2.*H.*cos(C) + A.*F.^2.*H.*cos(C) + 2.*A.*X.*F.*H.*sin(C) + 3.*X.*Y.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*cos(C) + Y.*F.*G.*H.^2.*sin(C)))./(2.*((F.^2 + Y.^2.*H.^2 + X.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2)) + ((X.*H.*cos(C) + F.*H.*sin(C)).*(imag((- 8.*(F.^2 - sin(C).*F.*H.*1i + Y.^2.*H.^2 - cos(C).*X.*H.*1i + X.^2).*(2.*A.^2.*X.^2.*H.^2.*cos(C).^2 - 2.*A.^2.*X.^2.*F.^2 - 2.*Y.^4.*G.^2.*H.^4 - 2.*A.^2.*X.^4 + 4.*Y.^2.*G.^2.*H.^4.*cos(C).^2 + 4.*F.^2.*G.^2.*H.^2.*cos(C).^2 + 2.*X.^2.*G.^2.*H.^2.*sin(2.*C) + 2.*Y.^2.*G.^2.*H.^4.*sin(2.*C) + A.^2.*X.^3.*H.*cos(C).*4i - 2.*A.^2.*X.^2.*Y.^2.*H.^2 - 2.*X.^2.*Y.^2.*G.^2.*H.^2 - 2.*Y.^2.*F.^2.*G.^2.*H.^2 - 4.*A.*X.^3.*Y.*G.*H + X.*Y.^2.*G.^2.*H.^3.*cos(C).*4i - 4.*X.*F.*G.^2.*H.^2.*cos(C).^2 + Y.^2.*F.*G.^2.*H.^3.*cos(C).*4i + A.^2.*X.*F.*H.^2.*sin(2.*C) - 2.*X.*F.*G.^2.*H.^2.*sin(2.*C) - 4.*A.*X.*Y.^3.*G.*H.^3 + A.^2.*X.*F.^2.*H.*cos(C).*2i + A.^2.*X.^2.*F.*H.*sin(C).*2i + A.*X.^2.*Y.*G.*H.^2.*cos(C).*8i + 6.*A.*X.*Y.*G.*H.^3.*cos(C).^2 + A.*Y.*F.^2.*G.*H.^2.*cos(C).*2i + 2.*A.*X.*Y.*G.*H.^3.*sin(2.*C) + A.*Y.*F.*G.*H.^3.*sin(2.*C) - 4.*A.*X.*Y.*F.^2.*G.*H + A.*X.*Y.*F.*G.*H.^2.*cos(C).*4i + A.*X.*Y.*F.*G.*H.^2.*sin(C).*2i) + (A.*X.^3.*4i + A.*X.*F.^2.*4i + Y.^3.*G.*H.^3.*4i + A.*X.*Y.^2.*H.^2.*4i + 6.*A.*X.^2.*H.*cos(C) + 2.*A.*F.^2.*H.*cos(C) - A.*X.*H.^2.*cos(C).^2.*2i - Y.*G.*H.^3.*cos(C).^2.*4i - A.*F.*H.^2.*sin(2.*C).*1i - Y.*G.*H.^3.*sin(2.*C).*2i + X.^2.*Y.*G.*H.*4i + Y.*F.^2.*G.*H.*4i + 4.*A.*X.*F.*H.*sin(C) + 6.*X.*Y.*G.*H.^2.*cos(C) + 4.*Y.*F.*G.*H.^2.*cos(C) + 2.*Y.*F.*G.*H.^2.*sin(C)).^2).^(1./2))./2 + 2.*A.*X.^3 + 2.*A.*X.*F.^2 + 2.*Y.^3.*G.*H.^3 + 2.*A.*X.*Y.^2.*H.^2 - A.*X.*H.^2.*cos(C).^2 - 2.*Y.*G.*H.^3.*cos(C).^2 - (A.*F.*H.^2.*sin(2.*C))./2 - Y.*G.*H.^3.*sin(2.*C) + 2.*X.^2.*Y.*G.*H + 2.*Y.*F.^2.*G.*H))./(2.*((F.^2 + Y.^2.*H.^2 + X.^2).^2 + (X.*H.*cos(C) + F.*H.*sin(C)).^2));

UP=UP2-UP1;


%
subplot(2,2,4)
surf(X,Y,UP);

zlim([-inf,inf])

legend('Re[\lambda]_{x_2}-Re[\lambda]_{x_1(base-state)} at k_b=10','Location','northwest')

%colorbar;
xlabel('k_a')
ylabel('k_{\theta}')
zlabel('\Delta Re[\lambda]')
title('k_b=10')


%title('Comparison of characteristic planes between real-state and base-state','FontSize',30)